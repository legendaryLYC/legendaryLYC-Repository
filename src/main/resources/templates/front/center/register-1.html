<!DOCTYPE html>
<html data-n-head-ssr="" data-n-head="" xmlns:th="http://www.thymeleaf.org">
<head th:include="front/common/_meta :: header"/>
<head>
 <link data-n-head="true" rel="icon" type="image/x-icon" th:href="@{/font/favicon.ico.css}" href="favicon.ico.css"/>
 <script data-n-head="true" th:src="@{/font/js/jquery.min.js}" src="js/jquery.min.js"></script>
 <script data-n-head="true" th:src="@{/font/js/index.js}" src="js/index.js"></script>
 <link rel="stylesheet" type="text/css" th:href="@{/font/css/el.css}" href="css/el.css">
 <link rel="stylesheet" type="text/css" th:href="@{/font/css/register.css}" href="css/register.css">
</head>
<body data-n-head="">
<style>
 #tel-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
 #password-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
 #confirmPassword-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
 #account-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
 #typeCode-error{
  font-size:9px;
  color:red;
  position: absolute;
  top:20px;
  right:10px;
 }
 #name-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
 #bankcardnum-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
 #code-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
 #idcode-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:4px;
 }
 #email-error{
  font-size:9px;
  color:red;
  position: absolute;
  right:10px;
 }
</style>
<div data-server-rendered="true" id="__nuxt">
 <div class="nuxt-progress" style="width:0%;height:2px;background-color:#3B8070;opacity:0;"></div>
 <div id="__layout">
  <div>
   <div data-v-f11a6d84>
    <!-- 公共顶部header -->
    <header th:include="front/common/_header :: header" class="header" data-v-8e52717c></header>
    <!-- 公共导航 -->
    <nav th:include="front/common/_nav :: nav" class="nav_index" data-v-bdccf15a></nav>
    <div class="asider" data-v-f11a6d84>
     <ul></ul>
    </div>
    <div class="register" data-v-f11a6d84 style="height:860px;">
     <div class="container" data-v-f11a6d84>
      <div class="register_box" data-v-f11a6d84 style="height:735px;">
       <div class="skewing" data-v-f11a6d84>
        <h4 data-v-f11a6d84>加入建筑众包</h4>
        <form class="el-form" id="proform" enctype="multipart/form-data"  method="post" data-v-f11a6d84>
         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwdCheck" class="el-form-item__label" style="width:100px;">姓名</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84 >
            <input autocomplete="off" type="text" rows="2" validateevent="true" value="" class="el-input__inner" id = "name" name = "name"/>
           </div>
          </div>
         </div>
         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="account" class="el-form-item__label" style="width:100px;">手机号码</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84>
            <input autocomplete="off" type="account" rows="2" validateevent="true" value="" class="el-input__inner" id = "tel" name= "tel"/>
           </div>
          </div>
         </div>
         <div class="el-form-item is-required" style="width:550px;" data-v-f11a6d84>
          <label for="messageNumber" class="el-form-item__label" style="width:100px;">短信验证码</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" style="width:281px;" data-v-f11a6d84>
            <input autocomplete="off" type="messageNumber" rows="2" validateevent="true" value="" class="el-input__inner" id = "code" name= "code"/>
           </div>
           <button type="button" id="VerificationCode" class="el-button el-button--danger" style="margin-left:2px;" data-v-f11a6d84>
            <span>获取验证码</span></button>
          </div>
         </div>

         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="account" class="el-form-item__label" style="width:100px;">邮箱</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84>
            <input autocomplete="off" type="account" rows="2" validateevent="true" value="" class="el-input__inner" id = "email" name= "email"/>
           </div>
          </div>
         </div>

         <div pattern="^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,8}$" minlength="8" class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwd" class="el-form-item__label" style="width:100px;">密码</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84>
            <input autocomplete="off" type="password" rows="2" validateevent="true" value="" class="el-input__inner" id = "password" name = "password" />
           </div>
          </div>
         </div>
         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwdCheck" class="el-form-item__label" style="width:100px;">确认密码</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84>
            <input autocomplete="off" type="password" rows="2" validateevent="true" value="" class="el-input__inner" id = "confirmPassword" name = "confirmPassword"/>
           </div>
          </div>
         </div>
         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwdCheck" class="el-form-item__label" style="width:100px;">身份证号</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84>
            <input autocomplete="off" type="text" rows="2" validateevent="true" value="" class="el-input__inner" id = "idcode" name = "idcode"/>
           </div>
          </div>
         </div>
         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwdCheck" class="el-form-item__label" style="width:100px;">银行卡号</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84>
            <input autocomplete="off" type="text" rows="2" validateevent="true" value="" class="el-input__inner" id = "bankcardnum" name = "bankcardnum"/>
           </div>
          </div>
         </div>
         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwdCheck" class="el-form-item__label" style="width:100px;">设计师类别</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84>
            <label for="typeCode0" style="text-align: right;float: left;font-size: 14px;color: #606266;line-height: 40px;padding: 0 12px 0 0;box-sizing: border-box;width:60px;">建筑</label>
            <input autocomplete="off" type="checkbox" style="float:left ;margin-top:13px" value="1000" id = "typeCode0" name = "typeCode"/>
            <label for="typeCode1" style="text-align: right;float: left;font-size: 14px;color: #606266;line-height: 40px;padding: 0 12px 0 0;box-sizing: border-box;width:60px;">结构</label>
            <input autocomplete="off" type="checkbox" style="float:left ;margin-top:13px" value="1001" id = "typeCode1" name = "typeCode"/>
            <label for="typeCode2" style="text-align: right;float: left;font-size: 14px;color: #606266;line-height: 40px;padding: 0 12px 0 0;box-sizing: border-box;width:60px;">水</label>
            <input autocomplete="off" type="checkbox" style="float:left ;margin-top:13px" value="1002" id = "typeCode2" name = "typeCode"/>
            <label for="typeCode3" style="text-align: right;float: left;font-size: 14px;color: #606266;line-height: 40px;padding: 0 12px 0 0;box-sizing: border-box;width:60px;">电</label>
            <input autocomplete="off" type="checkbox" style="float:left ;margin-top:13px" value="1003" id = "typeCode3" name = "typeCode"/>
            <label for="typeCode4" style="text-align: right;float: left;font-size: 14px;color: #606266;line-height: 40px;padding: 0 12px 0 0;box-sizing: border-box;width:60px;">暖</label>
            <input autocomplete="off" type="checkbox" style="float:left ;margin-top:13px" value="1004" id = "typeCode4" name = "typeCode"/>
           </div>
          </div>
         </div>
        <!-- <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwdCheck" class="el-form-item__label" style="width:100px;">资质证书</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div class="el-input" data-v-f11a6d84 style=" position: relative;width: 280px; height: 100px;font-size: 14px;color: #222222;line-height: 33px; text-align: center;border: 1px solid #e8e8e8;background: #ffffff;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;">选择文件
            <input autocomplete="off" type="file" rows="2" style="width: 280px; height: 100px;font-size: 16px;color: #222222;line-height: 33px;text-align: center;border: 1px solid #e8e8e8;background: #ffffff;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;position: absolute;top: 0;left: 0;opacity: 0;margin: 0;" value="" />
           </div>
           <button type="button" class="el-button el-button&#45;&#45;danger" style="margin-left:2px;" data-v-f11a6d84>
            <span>上传</span></button>
          </div>
         </div>-->
<!--         <div class="el-form-item is-required" data-v-f11a6d84>
          <label for="passwdCheck" class="el-form-item__label" style="width:100px;">资质证书</label>
          <div class="el-form-item__content" style="margin-left:100px;">
           <div id ="covertext" class="el-input"  data-v-f11a6d84 style=" position: relative;  width: 395px; height: 100px;font-size: 14px;color: #222222;line-height: 100px; text-align: center;border: 1px solid #e8e8e8;background: #ffffff;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;">选择文件
           </div>
           <input  id = "coverImage" name = "coverImage" autocomplete="off" accept="image/png, image/jpeg, image/gif, image/jpg" type="file" rows="2" style="cursor:pointer;  width: 280px; height: 100px;font-size: 16px;color: #222222;line-height: 33px;text-align: center;border: 1px solid #e8e8e8;background: #ffffff;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;position: absolute;top: 0;left: 0;opacity: 0;margin: 0;"  />
          </div>
         </div>-->
         <div class="el-form-item" data-v-f11a6d84>

          <div class="el-form-item__content" style="margin-left:100px;">
           <label role="checkbox" aria-checked="true" class="el-checkbox is-checked" data-v-f11a6d84><span aria-checked="mixed" class="el-checkbox__input is-checked"><span class="el-checkbox__inner"></span><input type="checkbox" checked="checked" class="el-checkbox__original" /></span><span class="el-checkbox__label">我已阅读并同意
               </span></label>
           <span data-v-f11a6d84><a href="" th:href="@{/toProtool}" target="_blank" class="protocolLists" data-v-f11a6d84>服务条款</a></span>
          </div>
         </div>
         <div class="el-form-item" data-v-f11a6d84>
          <div class="el-form-item__content" style="margin-left:100px;">
           <input   id="subbtn" type="submit"  class="el-button loginBtn loginBtnS  el-button--primary"  value="&nbsp;&nbsp;注册&nbsp;&nbsp;" data-v-f11a6d84 /></input>
          </div>
         </div>
        </form>
       </div>
       <div class="goLogin" data-v-f11a6d84>
        已有账号
        <a href="login.htm" data-v-f11a6d84><span data-v-f11a6d84>前往登录</span></a>
       </div>
      </div>
     </div>
    </div>
    <div class="container" style="position:relative;" data-v-f11a6d84>
     <div transition="fade" class="backTop">
      <div class="back" style="display:none;">
       <a href="javascript:void(0)">
        <div>
         <img th:src="@{/font/images/icon_top.0189719.png}" alt="" />
        </div><p>顶部</p></a>
      </div>
     </div>
    </div>
    <!-- 公共底部 -->
    <div th:include="front/common/_footer :: footer" id="footer" data-v-407369c6 data-v-2a183b29></div>
   </div>
  </div>
 </div>
</div>
<!-- 公共js -->
<div th:include="front/common/_js :: js"></div>

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" th:src="@{/lib/jquery.validation/1.14.0/jquery.form.min.js}" src="lib/jquery.validation/1.14.0/jquery.form.min.js"></script>
<script type="text/javascript" th:src="@{/lib/jquery.validation/1.14.0/jquery.validate.js}" src="lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" th:src="@{/lib/jquery.validation/1.14.0/validate-methods.js}" src="lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" th:src="@{/lib/jquery.validation/1.14.0/messages_zh.js}"  src="lib/jquery.validation/1.14.0/messages_zh.js"></script>
<script type="text/javascript" th:src="@{/lib/My97DatePicker/4.8/WdatePicker.js}"  src="lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" th:src="@{/lib/layer/2.4/layer.js}" src="lib/layer/2.4/layer.js"></script>
<script type="text/javascript">
    /* 获取当前上传文件的路径并显示 */
    $('#coverImage').change(function(){
        var file = $("#coverImage").val();
        var fileName = getFileName(file);
        $('#covertext').text(fileName);
    });
    function getFileName(file){//通过第一种方式获取文件名
        var pos=file.lastIndexOf("\\");//查找最后一个\的位置
        return file.substring(pos+1); //截取最后一个\位置到字符长度，也就是截取文件名
    }
    $(function(){
        $("#proform").validate({
            rules:{
                tel:{
                    required:true,
                    isMobileNum:true,
                },
                code:{
                    required:true,
                    isCode:true,
                },
                idcode:{
                    required:true,
                },
                password:{
                    required:true,
                    isPassword:true,
                },
                confirmPassword:{
                    required:true,
                    isPassword:true,
                    equalTo: "#password"
                },
                email:{
                    required:true,
                    isEmail:true,
                },
                account:{
                    required:true,
                },
                name:{
                    required:true,
                },
                typeCode:{
                    required:true,
                },
                bankcardnum:{
                	required:true,
                },
	            typeCode:{
	            	required:true,
	            },
            },
            onkeyup:false,
            success:"valid",
            submitHandler:function(form){

                $(form).ajaxSubmit({
                    type: 'post',
                    url: "/DesignerRegister/add" ,
                    success: function(data){
                        if(data.code == "000000"){
                            //禁止重复提交
                            $('#subbtn').attr("type","button");
                            layer.msg('恭喜您,注册成功!',{icon:1,time:1000},function(){
                                window.location.href = "/login";
                            });

                        }else{
                            layer.msg("error",{icon:5,time:2000});
                        }
                    },
                    error: function(XmlHttpRequest, textStatus, errorThrown){
                        layer.msg('注册失败!',{icon:5,time:2000});

                    }
                });

            },

        });
    });
    /* $("#subbtn").on("click",function(){

         var val1 = $("#tel").val();
          if(!(/^1[34578]\d{9}$/.test(val1))){
              // alert("手机号码有误，请重填");
              layer.designMsg("手机号码有误，请重填");
              return false;
          }
         var val2 = $("#code").val();
         var val3 = $("#password").val();
         var val4 = $("#confirmPassword").val();
          if(val3 != val4){
              alert("两次密码不一致，请重填");
              return false;
          }
         var val5 = $("#account").val();
         var val6 = $("#name").val();
         var val7 = $("#email").val();
         var data1 ={
                     'tel':val1,
                     'code':val2,
                     'password':val3,
                     'confirmPassword':val4,
                     'account':val5,
                     'name':val6,
                     'email':val7
         };
         $.ajax({
                url:"/DesignerRegister/add",// 跳转到 action
            data:data1,
                type:'post',
                success:function(data) {
                    if(data.code == "000000"){
                       layer.msg('注册成功!',{icon:1,time:3000},function(){
                           window.location.href = "/login";
                    });
                    }else{

                    }
                 },
                 error : function() {
                   layer.msg('注册失败!',{icon:1,time:3000});
                 }
            });
     });
 }); */

    //获取验证码ajax
    $('#VerificationCode').on("click",function() {
        var val1 = $("#tel").val();
        if(!(/^1[23456789]\d{9}$/.test(val1))){
            layer.designMsg("手机号码有误，请重填");
            return false;
        }
        $.ajax({
            url:"/DesignerRegister/SendCode",// 跳转到 action
            data:{
                'phoneNumbers':val1
            },
            type:'post',
            success:function(data) {
                if(data.code == "000000"){
                    timeKeep();
                    layer.msg('发送成功,请稍后!',{icon:1,time:1000},function(){
                    });
                }else if(data.code == "111111"){
                    layer.msg('该手机号码已经被注册过了!',{icon:5,time:3000},function(){
                    });
                }else{
                    layer.msg('发送验证码失败!',{icon:5,time:3000},function(){
                    });
                }
            },
            error : function() {
                layer.msg('发送失败!',{icon:5,time:1000},function(){

                });
            }
        });

    });



    function timeKeep() {

        var thisEle = $("#VerificationCode").css("font-size");
        //parseFloat的第二个参数表示转化的进制，10就表示转为10进制
        var textFontSize = parseFloat(thisEle , 10);
        //javascript自带方法
        var unit = thisEle.slice(-2); //获取单位
        var textFontSize = textFontSize-6 ;
        let count = 60;
        const countDown = setInterval(() => {
            if (count === 0) {
            textFontSize = textFontSize+7 ;
            $('#VerificationCode').css(
                'font-size', textFontSize + unit
            );
            $('#VerificationCode').text('重新发送').removeAttr('disabled');
            $('#VerificationCode').css({
                background: '#ff9400',
                color: '#fff',
            });
            clearInterval(countDown);
        } else {
            $('#VerificationCode').attr('disabled', true);
            $('#VerificationCode').css({
                background: '#d8d8d8',
                color: '#707070',
            });
            $('#VerificationCode').css(
                'font-size', textFontSize + unit
            );
            $('#VerificationCode').text(count + '秒后可重新获取');
        }
        count--;
    }, 1000);
    };



    /*自定义验证手机号码*/
    jQuery.validator.addMethod("isMobileNum", function(value, element) {
        var length = value.length;
        return this.optional(element) || (length == 11 && /^(((13[0-9]{1})|(14[0-9]{1})|(15[0-35-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/.test(value));
    }, "手机号码格式不正确");

    /*自定义验证验证码*/
    jQuery.validator.addMethod("isCode", function(value, element) {
        var length = value.length;
        return this.optional(element) || (length == 4 && /^\d{4}$/.test(value));
    }, "验证码格式不正确");

    /*自定义验证密码*/
    jQuery.validator.addMethod("isPassword", function(value, element) {
        var length = value.length;
        return this.optional(element) || ( /^(\w){6,20}$/.test(value));
    }, "密码格式不正确");
    /*  自定义验证邮箱格式 */
    jQuery.validator.addMethod("isEmail", function(value, element) {
        return this.optional( element ) || (/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(value));
    }, "邮箱格式不正确");

    jQuery.validator.addMethod("validateTypeCode", function() {
    /*  自定义验证设计师类别复选框 */
     var count = 0;
     $(function(){
      $("input[name='typeCode']:checkbox").each(function () {
       count++;
      })
     })
     if(count>0){
      return true;
     }
     else{
      return false;
     }
    }, "请至少选择一个专业类别")
</script>
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>