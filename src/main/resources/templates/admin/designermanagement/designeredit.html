<!DOCTYPE HTML>
<html  xmlns:th="http://www.thymeleaf.org">
<head th:include="_meta :: header">
<title>设计师信息编辑 </title>
</head>
<body>
<style>
	#submit{
		width:15%;
	}
</style>
<article class="page-container">
	<form class="form form-horizontal" id="form-purchase-add" action="#" th:action="@{/admin/Usermanagement/designersave}">
	<!-- <input type="hidden" name="save" value="true"/> -->
	
	<div class="row cl" style="margin-bottom:4%;display:none;">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red"></span>用户ID：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" readonly="readonly" class="input-text" placeholder="用户ID" name="id" id="id" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getId()}"/>
		</div>
	</div>
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>设计师名称：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="设计师名称" name="username" id="username" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getUsername()}"/>
		</div>
	</div>
	
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>昵称：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="昵称" name="nickname" id="nickname" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getNickname()}"/>
		</div>
	</div>
	
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>擅长领域：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" id="goodatcode" name="goodatcode" style="display:none;" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getCode()}"/>
				<input type="checkbox" name="goodat" onclick="checkbox()" th:each="list,stat:${list}" th:text="${list.description}" th:checked="${isCkecked.get(stat.index) eq '1'}"  th:value="${list.code}">
			<br>
			<!-- <select id="typecode" name="typecode"  class="text-input"  style="width:290px;height:35px;" th:value="${designerdetail.getDescription()}">
				<option value="">待选择</option>
				<option th:each="type:${designertype}" th:text="${type.description}" 
					th:value="${type.code}" th:selected="${designerdetail.getCode() eq type.code}">
					空
				</option>
			</select> -->
		</div>
	</div>
	
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>电话号码：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="电话号码" name="tel" id="tel" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getTel()}"/>
		</div>
	</div>
	
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>邮箱：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="邮箱" name="email" id="email" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getEmail()}"/>
		</div>
	</div>
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>开户行：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="开户行" id="deposit" th:value="工商银行"/>
		</div>
	</div>
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>账户名称：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="账户名称" id="accuntName" th:value="李先生"/>
		</div>
	</div>
<!--	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>资质证书</label>
		<div class="formControls col-xs-7 col-sm-5">
			<div class="el-input" data-v-f11a6d84 style=" position: relative;width: 280px; height: 100px;font-size: 14px;color: #222222;line-height: 33px; text-align: center;border: 1px solid #e8e8e8;background: #ffffff;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;">选择文件
				<input autocomplete="off" type="file" rows="2" style="width: 280px; height: 100px;font-size: 16px;color: #222222;line-height: 33px;text-align: center;border: 1px solid #e8e8e8;background: #ffffff;-webkit-border-radius: 4px;-moz-border-radius: 4px;border-radius: 4px;position: absolute;top: 0;left: 0;opacity: 0;margin: 0;" value="" />
			</div>
		</div>
	</div>-->
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red"></span>简介：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="简介" name="introduction" id="introduction" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getIntroduction()}"/>
		</div>
	</div>
	
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>常用地区：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="常用地区" name="commonAddress" id="commonAddress" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getCommonAddress()}"/>
		</div>
	</div>

	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>地区：</label>
		<!-- <div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="地区" name="area" id="area" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getArea()}"/>
		</div>  -->



		 <div class="el-form-item__content" style="margin-left: 273px;">
				<div class="el-row" >
				 <div class="el-col el-col-6">
				  <div class="el-input el-input--suffix"style="float:left;">
					  <select id="province" name="provinceId"class=" el-input__inner" >
						<option value="" disabled selected style='display:none;'>请选择省</option>
						<option th:each="pro:${provinces}" th:text="${pro.getName()}" th:value="${pro.getProvinceId()}"
							th:selected="${leadingUser.provinceId != null and leadingUser.provinceId.toString() eq pro.getProvinceId()}">空</option>
					  </select>
					  <span class="el-input__suffix">
						<span class="el-input__suffix-inner">
							<i class="el-select__caret el-input__icon el-icon-arrow-down"></i>
						</span>
					  </span>
				  </div>
				 </div>
				 <div class="el-col el-col-6" id="cityDiv">
				   <div class="el-input el-input--suffix" style="margin-left:10px;float:left; ">
					  <select class=" el-input__inner" id="city" name="cityId">
						<option value='' disabled selected style='display:none;'>请选择市</option>
					  </select>
					<span id="cityRecord" th:text="${projectorForm.getCityId()}" style="display:none"></span>
					  <span class="el-input__suffix">
						<span class="el-input__suffix-inner">
							<i class="el-select__caret el-input__icon el-icon-arrow-down"></i>
						</span>
					  </span>
				  </div>
				 </div>
				 <div class="el-col el-col-6" id="areaDiv">
				  <div class="el-input el-input--suffix" style="margin-left:10px;float:left;">
					  <select class=" el-input__inner" id="areaId" name="areaId">
						<option value='' disabled selected style='display:none;'>请选择县</option>
					  </select>
					<span id="areaRecord" th:text="${projectorForm.getArea()}" style="display:none"></span>
					  <span class="el-input__suffix">
						<span class="el-input__suffix-inner">
							<i class="el-select__caret el-input__icon el-icon-arrow-down"></i>
						</span>
					  </span>
				  </div>
				 </div>
				</div>
			   </div>




	</div>
	
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red"></span>头像：</label>
		<div class="formControls col-xs-7 col-sm-5">
			
		</div>
		<div class="formControls col-xs-7 col-sm-8" style="float:left;">
	         	
	         	<img id="changeimg" th:src="${designerdetail.photo}" style ="height:30px;width:30px;"/>
				<input class="input-text upload-url" type="text"  readonly="" th:value=${designerdetail.getPhoto()} style="width:250px;height:33px;">
				<a href="javascript:void();" class="btn btn-primary upload-btn" onclick="document.getElementById('headImage').click()"><i class="Hui-iconfont"style="width:70px;height:30px;"></i> 浏览文件</a>
				<input type="file" name="headImage" id="headImage" class="el-upload__input" style="filter:alpha(opacity:0);opacity: 0;width:0px ;"size="28" onchange="changeImg()"/>
		</div>
	</div>

	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>性别：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<select id="sexType" name="sexType" disabled="disabled" style="width:290px;height:35px;" class="text-input"  >
				<option value="">待选择</option>
				<option value="1" th:selected="${designerdetail.sexType eq '1' }">男</option>
				<option value="0" th:selected="${designerdetail.sexType eq '0' }">>女</option>
			</select>
			<!-- <select id="typecode" name="typecode"  class="text-input"  style="width:290px;height:35px;" th:value="${designerdetail.getDescription()}">
				<option value="">待选择</option>
				<option th:each="type:${designertype}" th:text="${type.description}" 
					th:value="${type.code}" th:selected="${designerdetail.getCode() eq type.code}">
					空
				</option>
			</select> -->
		</div>
	</div>
	
	
<!--	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>资质评分：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="text" class="input-text" placeholder="资质评分" name="qualifyScore" id="qualifyScore" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getQualifyScore()}"/>
		</div>
	</div>-->
	
	<div class="row cl" style="margin-bottom:4%;">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>角色选择：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<select id="roleCode" name="roleCode"  disabled="disabled" style="width:290px;height:35px;" class="text-input"  >
				<option value="1001" th:selected="${designerdetail.roleCode eq '1001' }">设计师</option>
				<option value="1002" th:selected="${designerdetail.roleCode eq '1002' }">项目方</option>
			</select>
		</div>
	</div>
	
	
	<div class="row cl" style="margin-bottom:4%">
		<label class="form-label col-xs-4 col-sm-3 col-sm-offset-1"><span class="c-red">*</span>密码：</label>
		<div class="formControls col-xs-7 col-sm-5">
			<input type="password" class="input-text" placeholder="用户密码" name="password" id="password" th:each="designerdetail : ${designerdetail}" th:value="${designerdetail.getPassword()}"/>
		</div>
	</div>

	<div class="row cl">
		<div class="col-xs-3 col-sm-3 col-xs-offset-4 col-sm-offset-5" id="submit">
			<input class="btn btn-primary radius" id="subbtn" type="submit" value="&nbsp;&nbsp;提交&nbsp;&nbsp;"/>
		</div> 
		<div class="col-xs-3 col-sm-3">
			<input class="btn radius" id="reset" type="button" value="&nbsp;&nbsp;取消&nbsp;&nbsp;"/>
		</div>
	</div>
	</form>
</article>

<!--_footer 作为公共模版分离出去--> 
<div th:replace="_footer :: footerjs"></div>
 <!--/_footer 作为公共模版分离出去-->
<p th:text="${designerdetail.getSexType()}" id="sextypecode" style="display:none;"></p>
<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" th:src="@{/lib/jquery.validation/1.14.0/jquery.validate.js}" src="lib/jquery.validation/1.14.0/jquery.validate.js"></script> 
<script type="text/javascript" th:src="@{/lib/jquery.validation/1.14.0/validate-methods.js}" src="lib/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" th:src="@{/lib/jquery.validation/1.14.0/messages_zh.js}"  src="lib/jquery.validation/1.14.0/messages_zh.js"></script> 
<script type="text/javascript" th:src="@{/lib/My97DatePicker/4.8/WdatePicker.js}"  src="lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript">
function checkbox(){
	var list = new Array();
	$('input[name="goodat"]:checked').each(function(i) {
		list[i] = $(this).val();
	});
	if (list.length == 0) {
		layer.msg("请选择擅长类型");
		return false;
	}
	$("#goodatcode").val(list);
};
// 先调用一次函数，防止没有修改专业报错。
checkbox();
//性别回显
$(document).ready(function(){
	var num = $("#sextypecode").text();   //获取input中输入的数字
	var numbers = $("#sexType").find("option"); //获取select下拉框的所有值
	for (var i = 1; i < numbers.length; i++) {
		if ($(numbers[i]).val() == num) {
			$(numbers[i]).attr("selected", "selected");
		}
	}
});

$(function(){
	
	$("#form-purchase-add").validate({
		rules:{
            goodatcode:{
                required:true,
            },
            goodat:{
                required:true,
            },
            id:{
                required:true,
            },
            tel:{
                required:true,
                teltest:$("#tel").val() //调用自定义验证
            },
            email:{
                required:true,
                emailtest: $("#email").val() //调用自定义验证
            },
            commonAddress:{
                required:true,
            },
            introduction:{
                required:false,
            },
            areaId:{
                required:true,
            },
			headImage:{
                required:false,
            },
			photo:{
				required:false,
			},
            cityRecord:{
                required:false,
            },
            areaRecord:{
                required:false,
            },
            createTime:{
                required:true,
            },
            nickname:{
                required:true,
            },
            password:{
                required:true,
            },
            updateTime:{
                required:true,
            },
            username:{
                required:true,
            },
            roleCode:{
                required:true,
            },
            sexType:{
                required:true,
            },
			qualifyScore:{
				required:true,
				number:true,
				min: 0.01,// 输入的数字最小值为0.01，不能为0或者负数
				max:10,
				minNumber: $("#qualifyScore").val() //调用自定义验证
			},
		},
		onkeyup:false,
		success:"valid",
		
		submitHandler:function(form){
			$(form).ajaxSubmit({
				type: 'post',
				url: "/admin/Usermanagement/designersave" ,
				success: function(data){
					if(data.code == "1"){
						//禁止重复提交
						$('#subbtn').attr("type","button");
						layer.msg('修改成功!',{icon:1,time:1000},function(){
							var index = parent.layer.getFrameIndex(window.name);
							parent.location.reload();
							parent.layer.close(index); 
						});
					}else{
						layer.msg('error!'.message,{icon:5,time:1000});
					}
				},
                error: function(XmlHttpRequest, textStatus, errorThrown){
					layer.msg('error!',{icon:5,time:1000});
				}
			});
		
		}
	});
});

//自定义validate验证输入的数字小数点位数不能大于两位
jQuery.validator.addMethod("minNumber",function(value, element){
    var returnVal = true;
    inputZ=value;
  //截取字符串
    var ArrMen= inputZ.split("."); 
    if(ArrMen.length==2){
    	//判断小数点后面的字符串长度
        if(ArrMen[1].length>2){ 
            returnVal = false;
            return false;
        }
    }
    return returnVal;
},"小数点后最多为两位");         //验证错误信息

/**
 * 重置
 */
$('#reset').on('click',function(){
	var index = parent.layer.getFrameIndex(window.name);
	parent.layer.close(index); 
});

jQuery.validator.addMethod("emailtest",function(value, element){
    var returnVal = true;
  //截取字符串
  　　var myemail=value;
  　　var myReg=/^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/;
   
  　　if(myReg.test(myemail)){
  　　　　return true;
  　　}else{
  　　　　returnVal = false;
  		return false;
  	}
    return returnVal;
},"邮箱格式不正确！");         //验证错误信息

jQuery.validator.addMethod("teltest",function(value, element){
    var returnVal = true;
  //截取字符串
  　　var mytel=value;
  　　var myReg=/^[1][3,4,5,7,8,9][0-9]{9}$/;
   
  　　if(myReg.test(mytel)){
  　　　　return true;
  　　}else{
  　　　　returnVal = false;
  		return false;
  	}
    return returnVal;
},"手机号格式不正确！");


var result;
//选择省份事件
$("#province").change(function() {
	//先清空城市和区
	$("#city").empty();
	$("#areaId").empty();
	$('#city').append("<option value=''>待选择</option>");
	$('#areaId').append("<option value=''>待选择</option>");
	$('#city').css("display","block");
	$('#areaId').css("display","block");
	if($("#province").val()==""){
		//啥都不做
	}else{
		chooseDic("province",$("#province").val());
		// 如果查到的城市不为空，显示出城市列表 否则隐藏城市和地区列表
		if(result.length!=0){
			$('#cityDiv').css("display","inline");
			for (i in result){
				$('#city').append("<option value='"+result[i].cityId+"'>"+result[i].name+"</option>");
			}
		}
		else{
			$('#cityDiv').css("display","none");
			$('#areaDiv').css("display","none");
		}
	}
});
//选择城市事件
$("#city").change(function() {
	//先清空规格
	$("#areaId").empty();
	$('#areaId').append("<option value=''>待选择</option>");
	$('#areaId').css("display","block");
	if($("#city").val()==""){
		//啥都不做
	}else{
		chooseDic("city",$("#city").val());
		if(result.length!=0){
			$('#areaDiv').css("display","inline");
			for (i in result){
				$('#areaId').append("<option value='"+result[i].areaId+"'>"+result[i].name+"</option>");
			}
		}
		else {
			$('#areaDiv').css("display","none");
		}
	}
});
//选择下拉菜单时和后台要字典的交互方法
function chooseDic(who,code){
	var toServer={
		who : who,
		code : code,
	}
	//此处请求后台程序，下方是成功后的前台处理……
	$.ajax({
		type: 'POST',
		url: "/admin/projector/getareadic",
		dataType: 'json',
		data:toServer,
		async:false,
		success: function(data){
			//返回服务器返回的字典对象
			result = data;
			
		},
		error:function(data) {
			console.log("错误!");
		},
	});
}

//加载时请求回显省市区
$(function(){
	chooseDic("province",$("#province").val());
	if(result.length != 0){
		$('#cityDiv').css("display","inline");
		$('#areaDiv').css("display","inline");
		for (i in result){
			$('#city').append("<option value='"+result[i].cityId+"'>"+result[i].name+"</option>");
			$('#city').val($('#cityRecord').text());
		}
	}else{
		$('#cityDiv').css("display","none");
	}
	chooseDic("city",$("#city").val());
	if(result.length != 0){
		$('#areaDiv').css("display","inline");
		for (i in result){
			$('#areaId').append("<option value='"+result[i].areaId+"'>"+result[i].name+"</option>");
			$('#areaId').val($('#areaRecord').text());
		}
	}else{
		$('#areaDiv').css("display","none");
	}
});
function changeImg(){
	var reads = new FileReader();
	f = document.getElementById('headImage').files[0];
	reads.readAsDataURL(f);
	reads.onload = function(e) {
		document.getElementById('changeimg').src = this.result;
	};
}
</script>
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>